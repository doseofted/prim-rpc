import base.Caddyfile

{
  import log_options
  email {$ADMIN_EMAIL}
  # use below for staging environment
  # REFERENCE: https://caddyserver.com/docs/caddyfile/options#acme-ca
  # acme_ca https://acme-staging-v02.api.letsencrypt.org/directory
}

www.{$HOST} {
  redir https://{$HOST}{uri}
}

{$HOST} {
  reverse_proxy api:3001
  root * /srv
  file_server
}

api.{$HOST} {
  reverse_proxy backend:3001
}
